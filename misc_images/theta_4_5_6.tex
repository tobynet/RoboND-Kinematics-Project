\begin{align*}
\theta_4 &= arctan2(sin(q4), cos(q4)) \\
         &= arctan2(sin(q4)sin(q5), cos(q4)sin(q5)) \\ 
         & \\
\theta_5 &= arctan2(sin(q5), cos(q5)) \\
         &= arctan2(\sqrt{(-sin(q5)cos(q4))^2 + (sin(q4)sin(q5))^2},cos(q5)) \\
         & \\
\theta_6 &= arctan2(sin(q6), cos(q6)) \\
         &= arctan2(sin(q5)sin(q6), sin(q5)cos(q6)) \\ 
\end{align*}